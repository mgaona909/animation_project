<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Animation Project</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <script src="https://code.createjs.com/easeljs-0.6.0.min.js"></script> 
        
        <script type="text/javascript">
            var canvas;
            var stage;
            var screen_width;
            var screen_height;
            var bmpAnimation;

            var professor = new Image();

            function init() {
                canvas = document.getElementById("myCanvas");

                professor.onload = handleImageLoad;
                professor.onerror = handleImageError;
                professor.src = "professor.png";
            }

            function reset() {
                stage.removeAllChildren();
                createjs.Ticker.removeAllListeners();
                stage.update();
            }

            function handleImageLoad(e) {
                startGame();
            }

            function startGame() {
                // create a new stage and point it at our canvas:
                stage = new createjs.Stage(canvas);
                
                // grab canvas width and height for later calculations:
                screen_width = canvas.width;
                screen_height = canvas.height;
                
                // create spritesheet and assign the associated data.
                var spriteSheet = new createjs.SpriteSheet({
                    // image to use
                    images: [professor], 
                    // width, height & registration point of each sprite
                    frames: {width: 64, height: 64, regX: 32, regY: 32}, 
                    animations: {	
                        walk: [27, 35, "walk", 8]
                    }
                });
                
                //generate a new sprite sheet which includes the flipped animations
                createjs.SpriteSheetUtils.addFlippedFrames(spriteSheet, true, false, false);

                // create a BitmapAnimation instance to display and play back the sprite sheet:
                bmpAnimation = new createjs.BitmapAnimation(spriteSheet);

                // set the registration point (the point it will be positioned and rotated around)
	            // to the center of the frame dimensions:
	            bmpAnimation.regX = bmpAnimation.spriteSheet.frameWidth/2|0;
	            bmpAnimation.regY = bmpAnimation.spriteSheet.frameHeight / 2 | 0;

                // start playing the first sequence:
                // walk_h has been generated by addFlippedFrames and
                // contained the right facing animations
                bmpAnimation.gotoAndPlay("walk_h"); 	//walking from left to right
                

                bmpAnimation.name = "professor1";
                bmpAnimation.direction = -90;
                bmpAnimation.vX = 1;
                bmpAnimation.x = 16;
                bmpAnimation.y = 32;
                    
                // have each monster start at a specific frame
                bmpAnimation.currentFrame = 0;
                stage.addChild(bmpAnimation);
                    
                // we want to do some work before we update the canvas,
                // otherwise we could use Ticker.addListener(stage);
                createjs.Ticker.addListener(window);
                createjs.Ticker.useRAF = true;
                createjs.Ticker.setFPS(60);
            }

            //called if there is an error loading the image (usually due to a 404)
            function handleImageError(e) {
                console.log("Error Loading Image : " + e.target.src);
            }

            function tick() {
                // Hit testing the screen width, otherwise our sprite would disappear
                if (bmpAnimation.x >= screen_width - 16) {
                    // We've reached the right side of our screen
                    // We need to walk left now to go back to our initial position
                    bmpAnimation.direction = -90;
                    bmpAnimation.gotoAndPlay("walk_h")
                }
            
                if (bmpAnimation.x < 16) {
                    // We've reached the left side of our screen
                    // We need to walk right now
                    bmpAnimation.direction = 90;
                    bmpAnimation.gotoAndPlay("walk");
                }
            
                // Moving the sprite based on the direction & the speed
                if (bmpAnimation.direction == 90) {
                    bmpAnimation.x += bmpAnimation.vX;
                }
                else {
                    bmpAnimation.x -= bmpAnimation.vX;
                }
            
                // update the stage:
                stage.update();
            }
        </script>



    </head>
    <body>
        <canvas id="myCanvas" width="240" height="64" style="background-color:#607559">
            Your browser doesn't support canvas. Please download IE9+ on <a href="http://ie.microsoft.com/testdrive">IE Test Drive</a> 
        </canvas>
        <button id="Start" onclick="init();">Start</button>
        <button id="Reset" onclick="reset();">Reset</button>
    </body>
</html>